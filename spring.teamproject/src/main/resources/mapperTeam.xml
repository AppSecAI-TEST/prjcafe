<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.mysql.mapperTeam">
    
    <select id="login" parameterType="ModelUser" resultType="int">        
        SELECT count(*)
          FROM tb_cafe_user
         WHERE email = #{email} and passwd = #{passwd}
    </select>
   
    <select id="selectUserOne" parameterType="int" resultType="ModelUser">
             SELECT *
             FROM TB_cafe_user 
             WHERE userno = #{userno}
    </select>
    
    <select id="getTeamList"  parameterType="ModelUser"  >
        SELECT *
          FROM tb_cafe_user
        WHERE email like concat('%', #{email}, '%');
    </select>         
        
    <insert id="insertTeam" parameterType="ModelUser">
        INSERT INTO 
        tb_cafe_user ( email   , passwd   , userphone   , useraddr   ,   sex ,  emailselect   , usernickname )
        VALUES       ( #{email}, #{passwd}, #{userphone}, #{useraddr}, #{sex}, #{emailselect} , #{usernickname}  )
    </insert>
    
    <select id="getCafeList"  resultType="ModelCafeinfo">
        SELECT *
          FROM tb_cafe_cafeinfo
        ORDER BY cafeno asc;
    </select>

<update id="updateUserinfo" parameterType="hashmap">
        UPDATE tb_cafe_user
            SET email   = #{updateValue.email}
              , passwd     = #{updateValue.passwd}
              , userphone = #{updateValue.userphone}
              , useraddr = #{updateValue.useraddr}
              , sex = #{updateValue.sex}
              , usernickname = #{updateValue.usernickname}
              , emailselect = #{updateValue.emailselect}
              
            WHERE 1 = 1 
              <if test="searchValue.email != null and searchValue.email != ''" >
              AND email    = #{searchValue.email}
              </if>
              <if test="searchValue.passwd != null and searchValue.passwd != ''" >
              AND passwd    = #{searchValue.passwd}
              </if>
              <if test="searchValue.userphone != null and searchValue.userphone != ''" >
              AND userphone    = #{searchValue.userphone}
              </if>
              <if test="searchValue.useraddr != null and searchValue.useraddr != ''" >
              AND useraddr    = #{searchValue.useraddr}
              </if>
              <if test="searchValue.sex != null and searchValue.sex != ''" >
              AND sex    = #{searchValue.sex}
              </if>
              <if test="searchValue.usernickname != null and searchValue.usernickname != ''">
              AND usernickname    = #{searchValue.usernickname}
              </if>
              <if test="searchValue.emailselect != null and searchValue.emailselect != ''">
              AND emailselect    = #{searchValue.emailselect}
              </if>
    </update>
    
    <update id="updatePasswd" parameterType="hashmap" >
            UPDATE tb_cafe_user
            SET  passwd     = #{updateValue.passwd}
              WHERE 
                <if test="searchValue.email != null and searchValue.email != ''" >
               email    = #{searchValue.email}
              </if>
            
    </update>
    
    <delete id="deleteUser" parameterType="ModelUser" >
            DELETE FROM TB_cafe_user 
             WHERE 
             <if test="email != null and email != ''" >
               email    = #{email}
              </if>
           
    </delete>
 </mapper>
